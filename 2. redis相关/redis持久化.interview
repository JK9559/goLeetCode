redis的持久化有两种
1. 快照：
全量备份，存储紧凑，快照使用了多进程COW(Copy on Write)原理：
父进程fork出一个子进程，其中父进程继续对客户端请求进行处理，子进程只对数据进行读取，IO写入磁盘。
COW机制就是：当父进程对数据进行修改的时候 会复制出一份数据，这时子进程对应的数据是没有发生变化的
2. AOF日志：
增量备份，记录文本，可能量会很大，特点是先执行指令 再对数据进行存储
深入AOF：AOF是先将内容写在缓存中，再由内核异步的将数据写入磁盘，那么如果在AOF还未同步到磁盘，机器宕机了
怎么办？提供了fsync函数，可以强制将内容由内核刷到磁盘，redis通常配置了每隔1s执行一次fsync操作。

并且，对于redis来说 主机节点一般不会进行持久化操作，持久化操作主要在从节点进行。

持久化之后：
重启redis之后 很少会使用快照rdb来恢复redis 因为会丢失大量的数据，但是重放AOF会消耗很多时间
所以用了混合持久化，rdb之后 AOF快照开始到结束的数据。